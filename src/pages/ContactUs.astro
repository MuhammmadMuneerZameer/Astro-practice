---
import Splineanimation from '../components/Splineanimation';
import Layout from '../layouts/Layout.astro';
import '../styles/global.css';
---

<Layout title="Contact Us - Let's Launch Something Great Together">
  <!-- Hero Section -->
  <section class="hero-section bg-black py-16 md:py-20 px-4 md:px-6 relative overflow-hidden">
    <div class="absolute inset-0 z-0 opacity-30">
      <Splineanimation client:only="react" />
    </div>
    <div class="max-w-4xl mx-auto text-center relative z-10">
      <h1 class="hero-title text-3xl md:text-6xl font-bold mb-4 md:mb-6 text-green-300">
        Let's Launch Something Great Together
      </h1>
      <p class="hero-subtitle text-base md:text-xl text-gray-300 leading-relaxed max-w-3xl mx-auto">
        We help online startups build bold, scroll-stopping brands from scratch. 
        Fill out the form and we'll connect within 24–48 hours.
      </p>
    </div>
  </section>

  <!-- Contact Form Section -->
  <section class="contact-section bg-black py-12 md:py-20 px-4 md:px-6">
    <div class="max-w-2xl mx-auto">
      <form id="contactForm" class="space-y-6">
        <div class="grid md:grid-cols-2 gap-4 md:gap-6">
          <div class="form-field space-y-2">
            <label for="firstName" class="block text-sm font-medium text-gray-300">First Name *</label>
            <input 
              type="text" 
              id="firstName" 
              name="firstName" 
              required
              class="w-full px-4 py-3 bg-[#1a1a1a] border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300 text-white"
              placeholder="John"
            >
          </div>
          <div class="form-field space-y-2">
            <label for="lastName" class="block text-sm font-medium text-gray-300">Last Name *</label>
            <input 
              type="text" 
              id="lastName" 
              name="lastName" 
              required
              class="w-full px-4 py-3 bg-[#1a1a1a] border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300 text-white"
              placeholder="Doe"
            >
          </div>
        </div>

        <div class="form-field space-y-2">
          <label for="email" class="block text-sm font-medium text-gray-300">Email Address *</label>
          <input 
            type="email" 
            id="email" 
            name="email" 
            required
            class="w-full px-4 py-3 bg-[#1a1a1a] border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300 text-white"
            placeholder="john@example.com"
          >
        </div>

        <div class="form-field space-y-2">
          <label for="company" class="block text-sm font-medium text-gray-300">Company/Startup Name</label>
          <input 
            type="text" 
            id="company" 
            name="company"
            class="w-full px-4 py-3 bg-[#1a1a1a] border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300 text-white"
            placeholder="Your Company"
          >
        </div>

        <div class="form-field space-y-2">
          <label for="budget" class="block text-sm font-medium text-gray-300">Project Budget</label>
          <select 
            id="budget" 
            name="budget"
            class="w-full px-4 py-3 bg-[#1a1a1a] border border-gray-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-300 text-white"
          >
            <option value="">Select Budget Range</option>
            <option value="$5k-$10k">$5,000 - $10,000</option>
            <option value="$10k-$25k">$10,000 - $25,000</option>
            <option value="$25k-$50k">$25,000 - $50,000</option>
            <option value="$50k+">$50,000+</option>
          </select>
        </div>

        <div class="form-field space-y-2">
          <label class="block text-sm font-medium text-gray-300">Services Needed</label>
          <div class="flex flex-wrap gap-2 md:gap-3">
            <label class="cursor-pointer">
              <input type="checkbox" name="services" value="Brand Identity" class="peer sr-only">
              <span class="inline-flex items-center px-3 md:px-4 py-2 rounded-full border border-gray-600 text-gray-300 bg-[#1a1a1a] hover:border-green-500 hover:text-green-400 transition-colors duration-200 peer-checked:bg-green-500 peer-checked:text-black peer-checked:border-green-500">
                Brand Identity & Logo Design
              </span>
            </label>
            <label class="cursor-pointer">
              <input type="checkbox" name="services" value="Web Development" class="peer sr-only">
              <span class="inline-flex items-center px-3 md:px-4 py-2 rounded-full border border-gray-600 text-gray-300 bg-[#1a1a1a] hover:border-green-500 hover:text-green-400 transition-colors duration-200 peer-checked:bg-green-500 peer-checked:text-black peer-checked:border-green-500">
                Web Development
              </span>
            </label>
            <label class="cursor-pointer">
              <input type="checkbox" name="services" value="UI/UX Design" class="peer sr-only">
              <span class="inline-flex items-center px-3 md:px-4 py-2 rounded-full border border-gray-600 text-gray-300 bg-[#1a1a1a] hover:border-green-500 hover:text-green-400 transition-colors duration-200 peer-checked:bg-green-500 peer-checked:text-black peer-checked:border-green-500">
                UI/UX Design
              </span>
            </label>
            <label class="cursor-pointer">
              <input type="checkbox" name="services" value="Digital Marketing" class="peer sr-only">
              <span class="inline-flex items-center px-3 md:px-4 py-2 rounded-full border border-gray-600 text-gray-300 bg-[#1a1a1a] hover:border-green-500 hover:text-green-400 transition-colors duration-200 peer-checked:bg-green-500 peer-checked:text-black peer-checked:border-green-500">
                Digital Marketing
              </span>
            </label>
            <label class="cursor-pointer">
              <input type="checkbox" name="services" value="Other" class="peer sr-only">
              <span class="inline-flex items-center px-3 md:px-4 py-2 rounded-full border border-gray-600 text-gray-300 bg-[#1a1a1a] hover:border-green-500 hover:text-green-400 transition-colors duration-200 peer-checked:bg-green-500 peer-checked:text-black peer-checked:border-green-500">
                Other
              </span>
            </label>
          </div>
        </div>

        <div class="form-field flex items-center">
          <input type="checkbox" id="consent" name="consent" required class="mr-3 accent-green-500">
          <label for="consent" class="text-sm text-gray-300">
            I agree to receive communications about my project *
          </label>
        </div>

        <button 
          type="submit" 
          id="submitBtn"
          class="w-full bg-green-500 hover:bg-green-600 text-black font-bold py-4 px-8 rounded-full transition duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
        >
          <span id="submitText">Send My Project Brief</span>
          <span id="loadingIcon" class="hidden ml-2">...</span>
        </button>
      </form>

      <!-- Success Message -->
      <div id="successMessage" class="hidden mt-6 p-4 bg-green-500/20 border border-green-500 rounded-lg">
        <div class="text-center">
          <h3 class="font-bold text-green-400 mb-2">Message Sent Successfully!</h3>
          <p class="text-green-300">We'll get back to you within 24-48 hours.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Booking Calendar CTA -->
  <section class="cta-section bg-black py-12 md:py-20 px-4 md:px-6">
    <div class="max-w-4xl mx-auto text-center">
      <h2 class="text-2xl md:text-4xl font-bold mb-4 md:mb-6 text-green-300">
        Ready to Start Immediately?
      </h2>
      <p class="text-base md:text-lg text-gray-300 mb-6 md:mb-8">
        Book a free 30-minute strategy call to discuss your project in detail
      </p>
      <a 
        href="#" 
        class="inline-block bg-green-500 hover:bg-green-600 text-black font-bold py-3 px-6 rounded-full transition duration-300"
      >
        Schedule Free Consultation ↗
      </a>
    </div>
  </section>

  <!-- Testimonials Slider -->
  <section class="testimonials-section bg-black py-12 md:py-20 px-4 md:px-6">
    <div class="max-w-6xl mx-auto">
      <h2 class="text-2xl md:text-4xl font-bold text-center mb-8 md:mb-12 text-green-300">
        What Our Clients Say
      </h2>
      
      <div class="testimonial-slider overflow-hidden relative">
        <div class="testimonial-track flex transition-transform duration-500 ease-in-out">
          <div class="testimonial-slide flex-shrink-0 w-full px-2 md:px-4">
            <div class="bg-[#1a1a1a] p-4 md:p-6 rounded-xl max-w-2xl mx-auto">
              <div class="flex text-green-500 mb-3 md:mb-4">
                ⭐⭐⭐⭐⭐
              </div>
              <p class="text-gray-300 mb-4 md:mb-6 text-base md:text-lg italic">
                "The team completely transformed our startup's brand. The work helped us secure $2M in Series A funding."
              </p>
              <div class="flex items-center">
                <div class="w-10 h-10 md:w-12 md:h-12 bg-green-500 rounded-full flex items-center justify-center mr-3 md:mr-4">
                  <span class="font-bold text-black">SJ</span>
                </div>
                <div>
                  <p class="font-bold text-white">Sarah Johnson</p>
                  <p class="text-gray-400">CEO, TechStart Inc.</p>
                </div>
              </div>
            </div>
          </div>

          <div class="testimonial-slide flex-shrink-0 w-full px-2 md:px-4">
            <div class="bg-[#1a1a1a] p-4 md:p-6 rounded-xl max-w-2xl mx-auto">
              <div class="flex text-green-500 mb-3 md:mb-4">
                ⭐⭐⭐⭐⭐
              </div>
              <p class="text-gray-300 mb-4 md:mb-6 text-base md:text-lg italic">
                "Working with this team was amazing. They understood our vision and created a brand that truly represents who we are."
              </p>
              <div class="flex items-center">
                <div class="w-10 h-10 md:w-12 md:h-12 bg-green-500 rounded-full flex items-center justify-center mr-3 md:mr-4">
                  <span class="font-bold text-black">MR</span>
                </div>
                <div>
                  <p class="font-bold text-white">Mike Rodriguez</p>
                  <p class="text-gray-400">Founder, Digital Dynamics</p>
                </div>
              </div>
            </div>
          </div>

          <div class="testimonial-slide flex-shrink-0 w-full px-2 md:px-4">
            <div class="bg-[#1a1a1a] p-4 md:p-6 rounded-xl max-w-2xl mx-auto">
              <div class="flex text-green-500 mb-3 md:mb-4">
                ⭐⭐⭐⭐⭐
              </div>
              <p class="text-gray-300 mb-4 md:mb-6 text-base md:text-lg italic">
                "The attention to detail and creative approach exceeded our expectations. Our conversion rates improved by 300%!"
              </p>
              <div class="flex items-center">
                <div class="w-10 h-10 md:w-12 md:h-12 bg-green-500 rounded-full flex items-center justify-center mr-3 md:mr-4">
                  <span class="font-bold text-black">AL</span>
                </div>
                <div>
                  <p class="font-bold text-white">Alex Liu</p>
                  <p class="text-gray-400">CTO, InnovateNow</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="flex justify-center mt-6 md:mt-8 space-x-2">
          <button class="testimonial-dot w-2.5 h-2.5 md:w-3 md:h-3 rounded-full bg-green-500" data-slide="0"></button>
          <button class="testimonial-dot w-2.5 h-2.5 md:w-3 md:h-3 rounded-full bg-gray-600" data-slide="1"></button>
          <button class="testimonial-dot w-2.5 h-2.5 md:w-3 md:h-3 rounded-full bg-gray-600" data-slide="2"></button>
        </div>
      </div>
    </div>
  </section>

  <!-- Alternative Contact -->
  <section class="alternative-contact-section bg-black py-12 md:py-20 px-4 md:px-6 border-t border-gray-800">
    <div class="max-w-4xl mx-auto text-center relative">
      <div class="absolute inset-0 z-0 opacity-50 pointer-events-none">
        <Splineanimation client:only="react" />
      </div>
      <div class="relative z-10">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-green-300">
          Need Something Else?
        </h2>
        <p class="text-base md:text-lg text-gray-300 mb-8">
          Email us at <a href="mailto:muneer@hydrafoxdesigns.com" class="text-green-500 hover:text-green-400 underline">muneer@hydrafoxdesigns.com</a>
          <br class="md:hidden">
          or find us on IG <a href="https://instagram.com/hydrafoxdesigns" class="text-green-500 hover:text-green-400 underline">@hydrafoxdesigns</a>
        </p>
        
        <!-- Social Icons -->
        <div class="flex justify-center space-x-4">
          <a href="https://instagram.com/hydrafoxdesigns" target="blank" class="w-10 h-10 bg-[#1a1a1a] hover:bg-green-500 rounded-full flex items-center justify-center transition duration-300 group" aria-label="Instagram">
            <span class="text-green-500 group-hover:text-black">📷</span>
          </a>
          <a href="https://twitter.com/yourhandle" target="blank" class="w-10 h-10 bg-[#1a1a1a] hover:bg-green-500 rounded-full flex items-center justify-center transition duration-300 group" aria-label="Twitter">
            <span class="text-green-500 group-hover:text-black">🐦</span>
          </a>
          <a href="https://www.linkedin.com/company/hydrafoxdesign/"target="blank" class="w-10 h-10 bg-[#1a1a1a] hover:bg-green-500 rounded-full flex items-center justify-center transition duration-300 group" aria-label="LinkedIn">
            <span class="text-green-500 group-hover:text-black">💼</span>
          </a>
          <a href="https://www.behance.net/HYDRAFOXDESIGNS" target="blank" class="w-10 h-10 bg-[#1a1a1a] hover:bg-green-500 rounded-full flex items-center justify-center transition duration-300 group" aria-label="Dribbble">
            <span class="text-green-500 group-hover:text-black">🎨</span>
          </a>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script>
  document.addEventListener('DOMContentLoaded', async () => {
    // GSAP animations
    try {
      const { gsap } = await import('gsap');
      const { ScrollTrigger } = await import('gsap/ScrollTrigger');
      gsap.registerPlugin(ScrollTrigger);

      // Hero intro
      gsap.from('.hero-title', { y: 30, opacity: 0, duration: 0.9, ease: 'power3.out' });
      gsap.from('.hero-subtitle', { y: 20, opacity: 0, duration: 0.9, ease: 'power3.out', delay: 0.15 });

      // Form fields on scroll
      gsap.from('.contact-section .form-field', {
        opacity: 0,
        y: 24,
        duration: 0.6,
        stagger: 0.08,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '.contact-section',
          start: 'top 75%',
        },
      });

      // CTA fade in
      gsap.from('.cta-section > div', {
        opacity: 0,
        y: 24,
        duration: 0.8,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '.cta-section',
          start: 'top 80%',
        },
      });

      // Testimonials enter
      gsap.from('.testimonials-section .testimonial-slide', {
        opacity: 0,
        y: 20,
        duration: 0.6,
        stagger: 0.12,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '.testimonials-section',
          start: 'top 80%',
        },
      });

      // Alternative contact subtle fade
      gsap.from('.alternative-contact-section .relative.z-10', {
        opacity: 0,
        y: 16,
        duration: 0.8,
        ease: 'power2.out',
        scrollTrigger: {
          trigger: '.alternative-contact-section',
          start: 'top 85%',
        },
      });
    } catch (e) {
      console.warn('GSAP not loaded or failed to initialize:', e);
    }

    // Form handling
    const contactForm = document.getElementById('contactForm') as HTMLFormElement;
    const submitBtn = document.getElementById('submitBtn') as HTMLButtonElement;
    const submitText = document.getElementById('submitText') as HTMLSpanElement;
    const loadingIcon = document.getElementById('loadingIcon') as HTMLSpanElement;
    const successMessage = document.getElementById('successMessage') as HTMLDivElement;

    contactForm?.addEventListener('submit', async (e: Event) => {
      e.preventDefault();
      
      // Show loading state
      if (submitBtn) submitBtn.disabled = true;
      if (submitText) submitText.textContent = 'Sending...';
      if (loadingIcon) loadingIcon.classList.remove('hidden');

      try {
        // Get form data
        const formData = new FormData(contactForm);
        const services = Array.from(formData.getAll('services')) as string[];
        
        const contactData = {
          firstName: formData.get('firstName') as string,
          lastName: formData.get('lastName') as string,
          email: formData.get('email') as string,
          company: (formData.get('company') as string) || '',
          budget: (formData.get('budget') as string) || '',
          services: services,
          message: formData.get('message') as string,
          consent: formData.get('consent') === 'on'
        };

        console.log('Submitting form data:', contactData);

        // Submit to Firebase
        const { submitContactForm } = await import('../lib/contactForm.js');
        const result = await submitContactForm(contactData);

        console.log('Firebase result:', result);

        if (!result.success) {
          throw new Error(result.error);
        }
        
        // Show success message
        if (successMessage) successMessage.classList.remove('hidden');
        contactForm.reset();
        successMessage?.scrollIntoView({ behavior: 'smooth' });

      } catch (error) {
        console.error('Error submitting form:', error);
        alert('There was an error sending your message. Please try again or email us directly.');
      } finally {
        // Reset button state
        if (submitBtn) submitBtn.disabled = false;
        if (submitText) submitText.textContent = 'Send My Project Brief';
        if (loadingIcon) loadingIcon.classList.add('hidden');
      }
    });

    // Testimonial slider
    let currentSlide: number = 0;
    const slides = document.querySelectorAll('.testimonial-slide');
    const dots = document.querySelectorAll('.testimonial-dot');
    const track = document.querySelector('.testimonial-track') as HTMLDivElement;

    function goToSlide(slideIndex: number): void {
      currentSlide = slideIndex;
      if (track) {
        track.style.transform = `translateX(-${slideIndex * 100}%)`;
      }
      
      dots.forEach((dot, index) => {
        const dotElement = dot as HTMLButtonElement;
        if (index === slideIndex) {
          dotElement.classList.remove('bg-gray-600');
          dotElement.classList.add('bg-green-500');
        } else {
          dotElement.classList.remove('bg-green-500');
          dotElement.classList.add('bg-gray-600');
        }
      });
    }

    dots.forEach((dot, index) => {
      const dotElement = dot as HTMLButtonElement;
      dotElement.addEventListener('click', () => goToSlide(index));
    });

    // Auto-advance testimonials
    setInterval(() => {
      if (slides.length > 0) {
        currentSlide = (currentSlide + 1) % slides.length;
        goToSlide(currentSlide);
      }
    }, 5000);
  });
</script>